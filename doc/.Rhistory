y = ~count,
frame = ~year,
text = ~count,
# type="scatter",
# mode = "marker",
hoverinfo = "text",
name = 'Accident Number'
)
month.data %>%
plot_ly(
x = ~month,
y = ~count,
frame = ~year,
text = ~count,
hoverinfo = "text",
type="scatter",
mode = "marker"
)
library(shiny); runApp('Documents/GitHub/Spring2019-Proj2-grp13/app/accident_app.R')
month.data %>%
plot_ly(
x = ~month,
y = ~count,
frame = ~year,
text = ~count,
hoverinfo = "text",
type="scatter",
mode = "marker"
) %>%
animation_opts(
1000, easing = "elastic", redraw = FALSE
)
month.data %>%
plot_ly(
x = ~month,
y = ~count,
frame = ~year,
text = ~count,
hoverinfo = "text",
type="scatter",
mode = "marker",
name = "numebr of accident"
) %>%
animation_opts(
1000, easing = "elastic", redraw = FALSE
)
month.data %>%
plot_ly(
x = ~month,
y = ~count,
color = ~month,
frame = ~year,
text = ~count,
hoverinfo = "text",
type="scatter",
mode = "marker",
name = "numebr of accident"
) %>%
animation_opts(
1000, easing = "elastic", redraw = FALSE
)
runApp('Documents/GitHub/Spring2019-Proj2-grp13/app/accident_app.R')
runApp('Documents/GitHub/Spring2019-Proj2-grp13/app/accident_app.R')
runApp('Documents/GitHub/Spring2019-Proj2-grp13/app/accident_app.R')
runApp('Documents/GitHub/Spring2019-Proj2-grp13/app/accident_app.R')
devtools::install_github("ricardo-bion/ggradar",
dependencies=TRUE)
library(ggradar)
library(scales)
library(tibble)
mtcars %>%
rownames_to_column( var = "group" ) %>%
mutate_at(vars(-group),funs(rescale)) %>%
tail(4) %>% select(1:10) -> mtcars_radar
ggradar(mtcars_radar)
data.78.88 <- read.csv("AIDS_78-88.csv",na.strings=c("NA","NaN", " "))
data.89.07 <- read.csv("AIDS_89-07.csv",na.strings=c("NA","NaN", " "))
data.08.18 <- read.csv("AIDS_08-18.csv",na.strings=c("NA","NaN", " "))
data.18.19 <- read.csv("AIDS_18-19.csv")
dataset <- rbind(data.78.88,data.89.07,data.08.18,data.18.19)
rm(data.78.88,data.89.07,data.08.18,data.18.19)
str(dataset)
dataset2 <- dataset %>%
select('AIDS.Report.Number','Local.Event.Date','Event.City',
'Event.State','Event.Airport','Operator','Aircraft.Make','Total.Injuries','Aircraft.Damage','Aircraft.Damage','Event.Airport') %>%
mutate(Event.State = as.character(Event.State)) %>%
filter(Event.State %in% state.abb) %>%
mutate(Local.Event.Date = as.Date(Local.Event.Date,format = "%d-%b-%y"))
dataset2
View(dataset)
dataset2 <- dataset %>%
select('AIDS.Report.Number','Local.Event.Date','Event.City',
'Event.State','Event.Airport','Operator','Aircraft.Make','Total.Injuries','Aircraft.Damage','Aircraft.Damage','Event.Airport','Primary.Flight.Type') %>%
mutate(Event.State = as.character(Event.State)) %>%
filter(Event.State %in% state.abb) %>%
mutate(Local.Event.Date = as.Date(Local.Event.Date,format = "%d-%b-%y"))
str(datase2)
str(dataset2)
dataset2 <- dataset %>%
select('AIDS.Report.Number','Local.Event.Date','Event.City',
'Event.State','Event.Airport','Operator','Aircraft.Make','Total.Injuries','Aircraft.Damage','Aircraft.Damage','Event.Airport','Primary.Flight.Type') %>%
mutate(Event.State = as.character(Event.State)) %>%
filter(Event.State %in% state.abb) %>%
na.omit() %>%
mutate(Local.Event.Date = as.Date(Local.Event.Date,format = "%d-%b-%y"))
str(dataset2)
apply(dataset2, 1, fucntion(x) levels(x) = unique(x))
lapply(dataset2, 1, fucntion(x) levels(x) = unique(x))
lapply(dataset2, fucntion(x) levels(x) = unique(x))
levels(dataset2$Aircraft.Damage) <- unique(dataset2$Aircraft.Damage)
str(dataset2)
levels(Aircraft.Damage)
levels(dataset2$Aircraft.Damage)
data.78.88 <- read.csv("AIDS_78-88.csv",na.strings=c("NA","NaN", ""," "))
data.89.07 <- read.csv("AIDS_89-07.csv",na.strings=c("NA","NaN", ""," "))
data.08.18 <- read.csv("AIDS_08-18.csv",na.strings=c("NA","NaN", ""," "))
data.18.19 <- read.csv("AIDS_18-19.csv",na.strings=c("NA","NaN", ""," "))
dataset <- rbind(data.78.88,data.89.07,data.08.18,data.18.19)
rm(data.78.88,data.89.07,data.08.18,data.18.19)
dataset2 <- dataset %>%
select('AIDS.Report.Number','Local.Event.Date','Event.City',
'Event.State','Event.Airport','Operator','Aircraft.Make','Total.Injuries','Aircraft.Damage','Aircraft.Damage','Event.Airport','Primary.Flight.Type') %>%
mutate(Event.State = as.character(Event.State)) %>%
filter(Event.State %in% state.abb) %>%
na.omit() %>%
mutate(Local.Event.Date = as.Date(Local.Event.Date,format = "%d-%b-%y"))
str(dataset2)
dataset2 <- dataset %>%
select('AIDS.Report.Number','Local.Event.Date','Event.City',
'Event.State','Event.Airport','Operator','Aircraft.Make','Total.Injuries','Aircraft.Damage','Aircraft.Damage','Event.Airport','Primary.Flight.Type') %>%
mutate(Event.State = as.character(Event.State),
Local.Event.Date = as.Date(Local.Event.Date,format = "%d-%b-%y"),
year = year(Local.Event.Date)) %>%
filter(Event.State %in% state.abb) %>%
na.omit()
str(dataset2)
levels(dataset2$Primary.Flight.Type)
dataset <- dataset %>%
select('AIDS.Report.Number','Local.Event.Date','Event.City',
'Event.State','Event.Airport','Operator','Aircraft.Make',
'Aircraft.Damage','Primary.Flight.Type') %>%
mutate(Event.State = as.character(Event.State)) %>%
filter(Event.State %in% state.abb) %>%
mutate(Local.Event.Date = as.Date(Local.Event.Date,format = "%d-%b-%y"))
dataset2 <- dataset %>%
select('AIDS.Report.Number','Local.Event.Date','Event.City',
'Event.State','Event.Airport','Operator','Aircraft.Make','Aircraft.Damage','Primary.Flight.Type') %>%
mutate(Event.State = as.character(Event.State),
Local.Event.Date = as.Date(Local.Event.Date,format = "%d-%b-%y"),
year = year(Local.Event.Date)) %>%
filter(Event.State %in% state.abb) %>%
dataset %>%
select('AIDS.Report.Number','Aircraft.Damage','Primary.Flight.Type') %>%
na.omit() %>%
group_by('Aircraft.Damage','Primary.Flight.Type') %>%
summarize(count = n())
dataset %>%
select('AIDS.Report.Number','Aircraft.Damage','Primary.Flight.Type') %>%
na.omit() %>%
group_by('Aircraft.Damage','Primary.Flight.Type') %>%
summarize(count = n())
dataset %>%
select('AIDS.Report.Number','Aircraft.Damage','Primary.Flight.Type') %>%
na.omit()
dataset %>%
select('AIDS.Report.Number','Aircraft.Damage','Primary.Flight.Type') %>%
na.omit() %>%
summarize(count = n())
dataset %>%
select('AIDS.Report.Number','Aircraft.Damage','Primary.Flight.Type') %>%
na.omit() %>%
summarize(count = n())
dataset %>%
select('AIDS.Report.Number','Aircraft.Damage','Primary.Flight.Type') %>%
na.omit()
dataset %>%
select('AIDS.Report.Number','Aircraft.Damage','Primary.Flight.Type') %>%
na.omit() %>%
group_by('AIDS.Report.Number','Aircraft.Damage','Primary.Flight.Type')
dataset %>%
na.omit() %>%
group_by('AIDS.Report.Number','Aircraft.Damage','Primary.Flight.Type')
summarize(count = n()) %>%
select('AIDS.Report.Number','Aircraft.Damage','Primary.Flight.Type')
dataset %>%
select(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type) %>%
na.omit() %>%
group_by(Aircraft.Damage,Primary.Flight.Type)
dataset %>%
select(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type) %>%
na.omit() %>%
group_by(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type)
dataset %>%
select(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type) %>%
na.omit() %>%
group_by(Aircraft.Damage,Primary.Flight.Type)
dataset %>%
select(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type) %>%
na.omit() %>%
group_by(Aircraft.Damage,Primary.Flight.Type) %>%
summarize(count = n())
accident.reason <- dataset %>%
select(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type) %>%
na.omit() %>%
group_by(Aircraft.Damage,Primary.Flight.Type) %>%
summarize(count = n())
levels(dataset2)
levels(accident.reason$Primary.Flight.Type)
levels(accident.reason$Primary.Flight.Type)
levels(accident.reason$Aircraft.Damage)
accident.reason <- dataset %>%
select(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type) %>%
na.omit()
ggplot(accident.reason, aes(Primary.Flight.Type)) %>%
geom_bar(aes(fill = Aircraft.Damage))
ggplot(accident.reason, aes(Primary.Flight.Type)) +
geom_bar(aes(fill = Aircraft.Damage))
ggplot(accident.reason, aes(Primary.Flight.Type)) +
geom_bar(aes(fill = Aircraft.Damage)) +
coord_flip()
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_flip()
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type))
gsub("^AIR","AIR TAXI",accident.reason$Primary.Flight.Type)
gsub("^AIR*","AIR TAXI",accident.reason$Primary.Flight.Type)
gsub("^AIR.*","AIR TAXI",accident.reason$Primary.Flight.Type)
gsub("^ILLE.*","ILLEGAL",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub("^AIR.*","AIR TAXI",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub("^ILLE.*","ILLEGAL",accident.reason$Primary.Flight.Type)
levels(accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type
unqiue(accident.reason$Primary.Flight.Type)
unique(accident.reason$Primary.Flight.Type)
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type))
accident.reason$Primary.Flight.Type <- gsub(".*HELICOPTER","HELICOPTER",accident.reason$Primary.Flight.Type)
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type))
accident.reason$Primary.Flight.Type <- gsub(".*OPERATOR","SUPPLIMENTAL/COMMERCIAL",accident.reason$Primary.Flight.Type)
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type))
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
CoordFlip()
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coordllip()
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_fllip()
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_flip()
ggplot(accident.reason, aes(fct_reorder(Aircraft.Damage))) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_flip()
ggplot(accident.reason, aes(x = fct_reorder(Aircraft.Damage))) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_flip()
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_flip()
levels(accident.reason$Aircraft.Damage)
levels(accident.reason$Aircraft.Damage) <- c("DESTROYED","SUBSTANTIAL","MINOR","NONE","UNKNOWN")
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_flip()
levels(accident.reason$Aircraft.Damage) <- c("UNKNOWN","NONE","MINOR","SUBSTANTIAL","DESTROYED")
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_flip()
accident.reason <- dataset %>%
select(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type) %>%
na.omit() %>%
group_by(Aircraft.Damage,Primary.Flight.Type) %>%
summarize(count = n())
accident.reason$Primary.Flight.Type <- gsub("^AIR.*","AIR TAXI",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub("^ILLE.*","ILLEGAL",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub(".*OPERATOR","SUPPLIMENTAL/COMMERCIAL",accident.reason$Primary.Flight.Type)
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_flip()
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(alpha = Primary.Flight.Type)) +
coord_flip()
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(color = Primary.Flight.Type)) +
coord_flip()
ggplot(accident.reason, aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_flip()
accident.reason %>%
arrange(desc(count))
accident.reason <- dataset %>%
select(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type) %>%
na.omit()
accident.reason$Primary.Flight.Type <- gsub("^AIR.*","AIR TAXI",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub("^ILLE.*","ILLEGAL",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub(".*OPERATOR","SUPPLIMENTAL/COMMERCIAL",accident.reason$Primary.Flight.Type)
accident.reason %>%
group_by(Aircraft.Damage,Primary.Flight.Type) %>%
summarize(count = n()) %>%
arrange(desc(count))
accident.reason %>%
group_by(Aircraft.Damage,Primary.Flight.Type) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
ggplot(aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_flip()
accident.reason %>%
ggplot(aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_flip()
# dataset2 <- dataset %>%
#   select('AIDS.Report.Number','Local.Event.Date','Event.City',
#          'Event.State','Event.Airport','Operator','Aircraft.Make','Aircraft.Damage','Primary.Flight.Type') %>%
#   mutate(Event.State = as.character(Event.State),
#          Local.Event.Date = as.Date(Local.Event.Date,format = "%d-%b-%y"),
#          year = year(Local.Event.Date)) %>%
#   filter(Event.State %in% state.abb)
main.reasons <- c('ILLEGAL','PERSONAL','AIR TAXI','SCHEDULED AIR CARRIER','BUSINESS')
accident.reason <- dataset %>%
select(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type) %>%
filter(Primary.Flight.Type %in% main.reasons) %>%
filter(Aircraft.Damage != 'UNKNOWN') %>%
na.omit()
accident.reason$Primary.Flight.Type <- gsub("^AIR.*","AIR TAXI",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub("^ILLE.*","ILLEGAL",accident.reason$Primary.Flight.Type)
# dataset2 <- dataset %>%
#   select('AIDS.Report.Number','Local.Event.Date','Event.City',
#          'Event.State','Event.Airport','Operator','Aircraft.Make','Aircraft.Damage','Primary.Flight.Type') %>%
#   mutate(Event.State = as.character(Event.State),
#          Local.Event.Date = as.Date(Local.Event.Date,format = "%d-%b-%y"),
#          year = year(Local.Event.Date)) %>%
#   filter(Event.State %in% state.abb)
main.reasons <- c('ILLEGAL','PERSONAL','AIR TAXI','SCHEDULED AIR CARRIER','BUSINESS')
accident.reason <- dataset %>%
select(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub("^AIR.*","AIR TAXI",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub("^ILLE.*","ILLEGAL",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub(".*OPERATOR","SUPPLIMENTAL/COMMERCIAL",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub(".*HELICOPTER","HELICOPTER",accident.reason$Primary.Flight.Type)
accident.reason <- accident.reason %>%
filter(Primary.Flight.Type %in% main.reasons & Aircraft.Damage != 'UNKNOWN') %>%
na.omit()
accident.reason %>%
ggplot(aes(Aircraft.Damage)) +
geom_bar(aes(fill = Primary.Flight.Type)) +
coord_flip()
str(accident.reason)
test <- melt(accident.reason, id.vars='AIDS.Report.Number')
test <- data.table::melt(accident.reason, id.vars='AIDS.Report.Number')
library(reshape2)
test <- melt(accident.reason, id.vars='AIDS.Report.Number')
test <- melt(accident.reason, id='AIDS.Report.Number')
test <- melt(accident.reason)
test
library(data.table)
test <- library(data.table)::melt(accident.reason)
test <- data.table::melt(accident.reason,id.vars='AIDS.Report.Number')
test
library(tidyverse)
test <- gather(accident.reason,~AIDS.Report.Number)
test <- gather(accident.reason,-AIDS.Report.Number)
# Check required packages
if (!require("tidyverse")) install.packages('tidyverse')
if(!require("lubridate")) install.packages('lubridate')
library(tidyverse)
library(lubridate)
# Data Pre-processing
data.78.88 <- read.csv("../data/AIDS_78-88.csv",na.strings=c("NA","NaN", ""))
data.89.07 <- read.csv("../data/AIDS_89-07.csv",na.strings=c("NA","NaN", ""))
data.08.18 <- read.csv("../data/AIDS_08-18.csv",na.strings=c("NA","NaN", ""))
data.18.19 <- read.csv("../data/AIDS_18-19.csv",na.strings=c("NA","NaN", ""))
dataset <- rbind(data.78.88,data.89.07,data.08.18,data.18.19)
rm(data.78.88,data.89.07,data.08.18,data.18.19)
dataset <- dataset %>%
select('AIDS.Report.Number','Local.Event.Date','Event.City',
'Event.State','Event.Airport','Operator','Aircraft.Make',
'Aircraft.Damage','Primary.Flight.Type') %>%
mutate(Event.State = as.character(Event.State)) %>%
filter(Event.State %in% state.abb) %>%
mutate(Local.Event.Date = as.Date(Local.Event.Date,format = "%d-%b-%y"))
# Count accident within each month for each year
month.data <- dataset %>%
mutate(year = year(Local.Event.Date),month = month(Local.Event.Date)) %>%
group_by(year,month) %>%
summarise(count = n())
# Different airports in state
airport.data <- dataset %>%
select(Local.Event.Date,Event.State,Event.Airport,Operator,Aircraft.Make) %>%
mutate(year = year(Local.Event.Date)) %>%
group_by(year,Event.State) %>%
summarise(count = n()) %>%
arrange(year,Event.State)
# Major Aircraft Maker
major.company = c("LOCKHEED","BOEING","AIRBUS")
aircraft.make <- dataset %>%
mutate(year = year(Local.Event.Date)) %>%
select(Aircraft.Make,AIDS.Report.Number,year) %>%
filter(Aircraft.Make %in% major.company) %>%
group_by(Aircraft.Make,year) %>%
summarise(count = n())  %>%
arrange(desc(count))
# Major Operator
# UNITED AIRLINES has two type of names, so I take both of them first then merge them into one
major.operator = c("DELTA AIR LINES INC","SPIRIT AIRLINES INC","JETBLUE AIRWAYS CORPORATION",
"UNITED AIRLINES, INC.","UNITED AIR LINES INC","FRONTIER AIRLINES INC","ALASKA AIRLINES INC",
"SOUTHWEST AIRLINES CO","HAWAIIAN AIRLINES INC","AMERICAN AIRLINES INC",
"SKYWEST AIRLINES INC","EXPRESSJET AIRLINES INC","ENVOY AIR INC")
operator <- dataset %>%
mutate(year = year(Local.Event.Date)) %>%
select(Operator,AIDS.Report.Number,year) %>%
filter(Operator != "",Operator %in% major.operator) %>%
group_by(Operator,year) %>%
summarise(count = n())
operator$Operator <- gsub('UNITED AIR LINES INC',replacement = "UNITED AIRLINES, INC.",operator$Operator)
# Accident Type and Damage
main.reasons <- c('ILLEGAL','PERSONAL','AIR TAXI','SCHEDULED AIR CARRIER','BUSINESS')
accident.reason <- dataset %>%
select(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub("^AIR.*","AIR TAXI",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub("^ILLE.*","ILLEGAL",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub(".*OPERATOR","SUPPLIMENTAL/COMMERCIAL",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub(".*HELICOPTER","HELICOPTER",accident.reason$Primary.Flight.Type)
accident.reason <- accident.reason %>%
filter(Primary.Flight.Type %in% main.reasons & Aircraft.Damage != 'UNKNOWN') %>%
na.omit()
# Save all cleaned data
write.csv(month.data, file = "../output/accident_month.csv", row.names = TRUE)
write.csv(airport.data, file = "../output/accident_state.csv", row.names = TRUE)
write.csv(aircraft.make, file = "../output/accident_aircraft.csv", row.names = TRUE)
write.csv(operator, file = "../output/accident_operator.csv", row.names = TRUE)
write.csv(accident.reason, file = "../output/accident_reason.csv", row.names = TRUE)
setwd("~/Documents/GitHub/Spring2019-Proj2-grp13/doc")
##  Project2 - yz3383
##  Accident data from AIDS system (https://www.asias.faa.gov)
# Check required packages
if (!require("tidyverse")) install.packages('tidyverse')
if(!require("lubridate")) install.packages('lubridate')
library(tidyverse)
library(lubridate)
# Data Pre-processing
data.78.88 <- read.csv("../data/AIDS_78-88.csv",na.strings=c("NA","NaN", ""))
data.89.07 <- read.csv("../data/AIDS_89-07.csv",na.strings=c("NA","NaN", ""))
data.08.18 <- read.csv("../data/AIDS_08-18.csv",na.strings=c("NA","NaN", ""))
data.18.19 <- read.csv("../data/AIDS_18-19.csv",na.strings=c("NA","NaN", ""))
dataset <- rbind(data.78.88,data.89.07,data.08.18,data.18.19)
rm(data.78.88,data.89.07,data.08.18,data.18.19)
dataset <- dataset %>%
select('AIDS.Report.Number','Local.Event.Date','Event.City',
'Event.State','Event.Airport','Operator','Aircraft.Make',
'Aircraft.Damage','Primary.Flight.Type') %>%
mutate(Event.State = as.character(Event.State)) %>%
filter(Event.State %in% state.abb) %>%
mutate(Local.Event.Date = as.Date(Local.Event.Date,format = "%d-%b-%y"))
# Count accident within each month for each year
month.data <- dataset %>%
mutate(year = year(Local.Event.Date),month = month(Local.Event.Date)) %>%
group_by(year,month) %>%
summarise(count = n())
# Different airports in state
airport.data <- dataset %>%
select(Local.Event.Date,Event.State,Event.Airport,Operator,Aircraft.Make) %>%
mutate(year = year(Local.Event.Date)) %>%
group_by(year,Event.State) %>%
summarise(count = n()) %>%
arrange(year,Event.State)
# Major Aircraft Maker
major.company = c("LOCKHEED","BOEING","AIRBUS")
aircraft.make <- dataset %>%
mutate(year = year(Local.Event.Date)) %>%
select(Aircraft.Make,AIDS.Report.Number,year) %>%
filter(Aircraft.Make %in% major.company) %>%
group_by(Aircraft.Make,year) %>%
summarise(count = n())  %>%
arrange(desc(count))
# Major Operator
# UNITED AIRLINES has two type of names, so I take both of them first then merge them into one
major.operator = c("DELTA AIR LINES INC","SPIRIT AIRLINES INC","JETBLUE AIRWAYS CORPORATION",
"UNITED AIRLINES, INC.","UNITED AIR LINES INC","FRONTIER AIRLINES INC","ALASKA AIRLINES INC",
"SOUTHWEST AIRLINES CO","HAWAIIAN AIRLINES INC","AMERICAN AIRLINES INC",
"SKYWEST AIRLINES INC","EXPRESSJET AIRLINES INC","ENVOY AIR INC")
operator <- dataset %>%
mutate(year = year(Local.Event.Date)) %>%
select(Operator,AIDS.Report.Number,year) %>%
filter(Operator != "",Operator %in% major.operator) %>%
group_by(Operator,year) %>%
summarise(count = n())
operator$Operator <- gsub('UNITED AIR LINES INC',replacement = "UNITED AIRLINES, INC.",operator$Operator)
# Accident Type and Damage
main.reasons <- c('ILLEGAL','PERSONAL','AIR TAXI','SCHEDULED AIR CARRIER','BUSINESS')
accident.reason <- dataset %>%
select(AIDS.Report.Number,Aircraft.Damage,Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub("^AIR.*","AIR TAXI",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub("^ILLE.*","ILLEGAL",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub(".*OPERATOR","SUPPLIMENTAL/COMMERCIAL",accident.reason$Primary.Flight.Type)
accident.reason$Primary.Flight.Type <- gsub(".*HELICOPTER","HELICOPTER",accident.reason$Primary.Flight.Type)
accident.reason <- accident.reason %>%
filter(Primary.Flight.Type %in% main.reasons & Aircraft.Damage != 'UNKNOWN') %>%
na.omit()
# Save all cleaned data
write.csv(month.data, file = "../output/accident_month.csv", row.names = TRUE)
write.csv(airport.data, file = "../output/accident_state.csv", row.names = TRUE)
write.csv(aircraft.make, file = "../output/accident_aircraft.csv", row.names = TRUE)
write.csv(operator, file = "../output/accident_operator.csv", row.names = TRUE)
write.csv(accident.reason, file = "../output/accident_reason.csv", row.names = TRUE)
accident.reason
runApp('~/Documents/GitHub/Spring2019-Proj2-grp13/app/accident_app.R')
